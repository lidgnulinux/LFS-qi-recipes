# Build recipe for havoc.
#
# Exit immediately on any error
set -e

program=havoc
version=0.7.0
release=0
description="minimal terminal emulator for wayland"
homepage="https://github.com/ii8/havoc"
license="MIT"
replace=havoc-git-static

tarname=0.7.0.tar.gz
fetch="https://github.com/ii8/havoc/archive/refs/tags/$tarname"

build() 
{
	unpack "${tardir}/$tarname"
	
	cd "$srcdir"
	
	# Set sane permissions
	chmod -R u+w,go-w,a+rX-s .

	# fix libffi which left behind 
	patch -p1 -i ${worktree}/fix_libffi_static_linked-0.7.0.patch

	make CFLAGS="-O2 -DNDEBUG -std=gnu17" LDFLAGS="-static" 
	make CFLAGS="-O2 -DNDEBUG -std=gnu17" LDFLAGS="-static" DESTDIR="$destdir" install 
}
